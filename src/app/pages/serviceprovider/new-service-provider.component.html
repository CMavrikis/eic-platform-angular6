<div class="uk-section-default uk-section uk-section-small uk-padding-remove-bottom" style="min-height: 325px">
  <div class="uk-container">
    <div class="uk-grid-margin uk-grid uk-grid-stack" uk-grid="">
      <div class="uk-width-1-1@m uk-first-column">

        <h1 class="uk-h3">
          <a (click)="showLogoUrlModal()" title="Click to add the url with the Service Provider Logo">
            <img class="el-image uk-border-rounded"
                 src="{{(newProviderForm && newProviderForm.get('logo').value) ? newProviderForm.get('logo').value : 'http://fvtelibrary.com/img/user/NoLogo.png'}}"
                 width="70">
          </a>Add New Service Provider
        </h1>

        <!-- TOP HELP CONTENT -->
        <app-help-content #topHelperContent [position]="'top'"
                          [ngClass]="topHelperContent.isPresent()?'uk-margin-medium-top uk-margin-medium-bottom':'clear-style'">
        </app-help-content>

        <div class="uk-container uk-margin-medium-top uk-margin-medium-bottom">
          <div class="uk-grid">

            <!-- LEFT HELP CONTENT -->
            <app-aside-help-content #leftHelperContent [position]="'left'"
                                    [ngClass]="leftHelperContent.isPresent()?'tm-sidebar uk-width-1-4@m uk-first-column':'clear-style'">
            </app-aside-help-content>


            <!-- MIDDLE -->
            <div class="uk-width-expand@m">

              <div class="middle-box animated fadeInDown ">

                <div *ngIf="errorMessage" class="uk-alert uk-alert-danger">{{errorMessage}}</div>

                <form [formGroup]="newProviderForm" class="uk-form-horizontal">
                  <div class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right" for="legalName">
                      {{legalNameDesc.label + (legalNameDesc.mandatory ? ' (*)' : '')}}
                    </label>
                    <div class="uk-form-controls">
                      <input id="legalName" class="uk-input" type="text" formControlName="legalName"
                             [ngClass]="{'uk-form-danger': !newProviderForm.get('legalName').valid && newProviderForm.get('legalName').dirty}">
                      <i><small>{{legalNameDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right" for="acronym">
                      {{ acronymDesc.label + (acronymDesc.mandatory ? ' (*)' : '')}}
                    </label>
                    <div class="uk-form-controls">
                      <input id="acronym" class="uk-input" type="text" formControlName="acronym"
                             [ngClass]="{'uk-form-danger': !newProviderForm.get('acronym').valid && newProviderForm.get('acronym').dirty}">
                      <i><small>{{acronymDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div class="uk-margin-bottom">
                  <label class="uk-form-label uk-text-right" for="legalForm">
                      {{ legalFormDesc.label + (legalFormDesc.mandatory ? ' (*)' : '')}}
                    </label>
                    <div class="uk-form-controls">
                      <input id="legalForm" class="uk-input" type="text" formControlName="legalForm"
                             [ngClass]="{'uk-form-danger': !newProviderForm.get('legalForm').valid && newProviderForm.get('legalForm').dirty}">
                      <i><small>{{legalFormDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right" for="website">
                      {{ websiteDesc.label + (websiteDesc.mandatory ? ' (*)' : '')}}
                    </label>
                    <div class="uk-form-controls">
                      <input id="website" class="uk-input" type="text" formControlName="website"
                             [ngClass]="{'uk-form-danger': !newProviderForm.get('website').valid && newProviderForm.get('website').dirty}">
                      <i><small>{{websiteDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right" for="contactInformation">
                      {{ providerDescriptionDesc.label + (providerDescriptionDesc.mandatory ? ' (*)': '')}}
                    </label>
                    <div class="uk-form-controls">
                      <input id="contactInformation" class="uk-input" type="text" formControlName="description"
                             [ngClass]="{'uk-form-danger': !newProviderForm.get('description').valid && newProviderForm.get('description').dirty}">
                      <i><small>{{providerDescriptionDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right" for="logo">
                      {{ providerLogoDesc.label + (providerLogoDesc.mandatory ? ' (*)': '')}}
                    </label>
                    <div class="uk-form-controls">
                      <input id="logo" class="uk-input" type="text" formControlName="logo"
                             [ngClass]="{'uk-form-danger': !newProviderForm.get('logo').valid && newProviderForm.get('logo').dirty}">
                      <i><small>{{providerLogoDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div formArrayName="multimedia" class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right">
                      {{providerMultimediaDesc.label + (providerMultimediaDesc.mandatory ? ' (*)' : '')}}
                    </label>
                    <div class="uk-form-controls">
                      <div *ngFor="let provider of getFieldAsFormArray('multimedia').controls; let i=index">
                        <input class="uk-input" type="text" [formControlName]="i"
                               [ngClass]="{'uk-form-danger': !getFieldAsFormArray('multimedia').get([i]).valid && getFieldAsFormArray('multimedia').get([i]).dirty,
                               'uk-width-5-6': (getFieldAsFormArray('multimedia').length > 1)}">
                        <a *ngIf="getFieldAsFormArray('multimedia').length > 1"
                           class="remove-element uk-padding-small" (click)="remove('multimedia', i)">
                          <i class="fa fa-times" aria-hidden="true"></i>
                        </a>
                      </div>
                      <div class="uk-width-1-1">
                        <a class="add-new-element" (click)="push('multimedia', false, true)">
                          <i class="fa fa-plus" aria-hidden="true"></i> Add {{providerMultimediaDesc.label}}
                        </a>
                      </div>
                      <i><small>{{providerMultimediaDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div formArrayName="tags" class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right">
                      {{providerTagsDesc.label + (providerTagsDesc.mandatory ? ' (*)' : '')}}
                    </label>
                    <div class="uk-form-controls">
                      <div *ngFor="let provider of getFieldAsFormArray('tags').controls; let i=index">
                        <input class="uk-input" type="text" [formControlName]="i"
                               [ngClass]="{'uk-form-danger': !getFieldAsFormArray('tags').get([i]).valid && getFieldAsFormArray('tags').get([i]).dirty,
                               'uk-width-5-6': (getFieldAsFormArray('tags').length > 1)}">
                        <a *ngIf="getFieldAsFormArray('tags').length > 1"
                           class="remove-element uk-padding-small" (click)="remove('tags', i)">
                          <i class="fa fa-times" aria-hidden="true"></i>
                        </a>
                      </div>
                      <div class="uk-width-1-1">
                        <a class="add-new-element" (click)="push('tags', false)">
                          <i class="fa fa-plus" aria-hidden="true"></i> Add {{providerTagsDesc.label}}
                        </a>
                      </div>
                      <i><small>{{providerTagsDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div formGroupName="location" class="uk-margin-bottom">
                    <div class="uk-margin-bottom">
                      <label class="uk-form-label uk-text-right" for="streetNameNumber">
                        {{ streetNameAndNumberDesc.label + (streetNameAndNumberDesc.mandatory ? ' (*)': '')}}
                      </label>
                      <div class="uk-form-controls">
                        <input id="streetNameNumber" class="uk-input" type="text" formControlName="streetNameNumber"
                               [ngClass]="{'uk-form-danger': !newProviderForm.get('location.streetNameNumber').valid && newProviderForm.get('location.streetNameNumber').dirty}">
                        <i><small>{{streetNameAndNumberDesc.desc}}</small></i>
                      </div>
                    </div>
                    <div class="uk-margin-bottom">
                      <label class="uk-form-label uk-text-right" for="postalCode">
                        {{ streetNameAndNumberDesc.label + (streetNameAndNumberDesc.mandatory ? ' (*)': '')}}
                      </label>
                      <div class="uk-form-controls">
                        <input id="postalCode" class="uk-input" type="text" formControlName="postalCode"
                               [ngClass]="{'uk-form-danger': !newProviderForm.get('location.postalCode').valid && newProviderForm.get('location.postalCode').dirty}">
                        <i><small>{{streetNameAndNumberDesc.desc}}</small></i>
                      </div>
                    </div>
                    <div class="uk-margin-bottom">
                      <label class="uk-form-label uk-text-right" for="city">
                        {{ cityDesc.label + (cityDesc.mandatory ? ' (*)': '')}}
                      </label>
                      <div class="uk-form-controls">
                        <input id="city" class="uk-input" type="text" formControlName="city"
                               [ngClass]="{'uk-form-danger': !newProviderForm.get('location.city').valid && newProviderForm.get('location.city').dirty}">
                        <i><small>{{cityDesc.desc}}</small></i>
                      </div>
                    </div>
                    <div class="uk-margin-bottom">
                      <label class="uk-form-label uk-text-right" for="region">
                        {{ regionDesc.label + (regionDesc.mandatory ? ' (*)': '')}}
                      </label>
                      <div class="uk-form-controls">
                        <input id="region" class="uk-input" type="text" formControlName="region"
                               [ngClass]="{'uk-form-danger': !newProviderForm.get('location.region').valid && newProviderForm.get('location.region').dirty}">
                        <i><small>{{regionDesc.desc}}</small></i>
                      </div>
                    </div>
                    <div class="uk-margin-bottom">
                      <label class="uk-form-label uk-text-right" for="region">
                        {{ countryDesc.label + (countryDesc.mandatory ? ' (*)': '')}}
                      </label>
                      <div class="uk-form-controls">
                        <input id="country" class="uk-input" type="text" formControlName="country"
                               [ngClass]="{'uk-form-danger': !newProviderForm.get('location.country').valid && newProviderForm.get('location.country').dirty}">
                        <i><small>{{countryDesc.desc}}</small></i>
                      </div>
                    </div>
                  </div>
                  <div formArrayName="certifications" class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right">
                      {{providerCertificationsDesc.label + (providerCertificationsDesc.mandatory ? ' (*)' : '')}}
                    </label>
                    <div class="uk-form-controls">
                      <div *ngFor="let provider of getFieldAsFormArray('certifications').controls; let i=index">
                        <input class="uk-input" type="text" [formControlName]="i"
                               [ngClass]="{'uk-form-danger': !getFieldAsFormArray('certifications').get([i]).valid && getFieldAsFormArray('certifications').get([i]).dirty,
                               'uk-width-5-6': (getFieldAsFormArray('certifications').length > 1)}">
                        <a *ngIf="getFieldAsFormArray('certifications').length > 1"
                           class="remove-element uk-padding-small" (click)="remove('certifications', i)">
                          <i class="fa fa-times" aria-hidden="true"></i>
                        </a>
                      </div>
                      <div class="uk-width-1-1">
                        <a class="add-new-element" (click)="push('certifications', false)">
                          <i class="fa fa-plus" aria-hidden="true"></i> Add {{providerCertificationsDesc.label}}
                        </a>
                      </div>
                      <i><small>{{providerCertificationsDesc.desc}}</small></i>
                    </div>
                  </div>
                  <div class="uk-margin-bottom">
                    <label class="uk-form-label uk-text-right" for="hostingLegalEntity">
                      {{hostingLegalEntityDesc.label + (hostingLegalEntityDesc.mandatory ? ' (*)' : '')}}
                    </label>
                    <div class="uk-form-controls">
                      <input id="hostingLegalEntity" class="uk-input" type="text" formControlName="hostingLegalEntity"
                                [ngClass]="{'uk-form-danger': !newProviderForm.get('hostingLegalEntity').valid && newProviderForm.get('hostingLegalEntity').dirty}">
                        <i><small>{{hostingLegalEntityDesc.desc}}</small></i>
                    </div>
                  </div>

                  <div class="uk-margin-small-bottom">
                    <h5>PROVIDER ADMINS</h5>
                    <i>An administrator will be added using your user information</i>
                  </div>
                  <div *ngIf="newProviderForm.get('users').value">
                    <div formArrayName="users" *ngFor="let user of usersArray.controls; let i = index">
                      <div class="uk-padding-small uk-margin-small-bottom">
                        <div class="uk-grid" [formGroupName]="i">
                          <div class="serviceDetails uk-width-1-5@m">
                            <input type="text" class="uk-input" formControlName="name"
                                   [ngClass]="{'uk-form-danger': !usersArray.controls[i].get('name').valid && usersArray.controls[i].get('name').dirty}">
                          </div>
                          <div class="serviceDetails uk-width-1-5@m">
                            <input type="text" class="uk-input" formControlName="surname"
                                   [ngClass]="{'uk-form-danger': !usersArray.controls[i].get('surname').valid && usersArray.controls[i].get('surname').dirty}">
                          </div>
                          <div class="serviceDetails  uk-width-2-5@m">
                            <input type="text" class="uk-input" formControlName="email"
                                   [ngClass]="{'uk-form-danger': !usersArray.controls[i].get('email').valid && usersArray.controls[i].get('email').dirty}">
                          </div>
                          <div class="uk-width-1-5@m">
                            <a class=""
                               (click)="deleteUser(i)"><i class="fa fa-times" aria-hidden="true"></i>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="uk-margin-small-bottom uk-width-1-1@m uk-float-right">
                      <a class="" (click)="addUser()"><i class="fa fa-plus" aria-hidden="true"></i>
                        New Admin Provider</a>
                    </div>
                  </div>

                  <div>
                    <button class="uk-button butn theme" type="submit" (click)="registerProvider()">Submit
                    </button>
                  </div>
                </form>
              </div>

              <!-- RIGHT HELP CONTENT -->
              <app-aside-help-content #rightHelperContent [position]="'right'"
                                      [ngClass]="rightHelperContent.isPresent()?'tm-sidebar uk-width-1-4@m uk-first-column':'clear-style'">
              </app-aside-help-content>

            </div>
          </div>


          <!-- BOTTOM HELP CONTENT -->
          <app-help-content #bottomHelperContent [position]="'bottom'"
                            [ngClass]="bottomHelperContent.isPresent()?'uk-margin-medium-top uk-margin-medium-bottom':'clear-style'">
          </app-help-content>


        </div>
      </div>
    </div>
  </div>
</div>

<div id="logoUrlModal" uk-modal>
  <div class="uk-modal-dialog uk-modal-body">
    <label for="newLogo" class="uk-form-label">new logo url</label>
    <input type="text" #newLogo id="newLogo" class="uk-input uk-margin-bottom" value="{{logoUrl}}">
    <button class="uk-button uk-button-primary" type="button" (click)="addLogoUrl(newLogo.value)">Add</button>
    <button class="uk-button uk-button-primary uk-modal-close" type="button">Cancel</button>
  </div>
</div>
